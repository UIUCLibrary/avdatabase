{% extends "details_table.html" %}
{% from "_macros.html" import notes_table_head, notes_table_row, notes_new_button_row %}
{% from "_details_macros.html" import add_field_row %} }}
{% block entity_navbar %}
    <nav class="navbar navbar-expand-lg  navbar-light justify-content-start bg-light">
        <div class="mx-1">
            <button class="btn btn-outline-primary "
                    type="button"
                    disabled
            >New</button>
        </div>
    </nav>
{% endblock %}
{% block detail_table %}
    <div class="card my-1">
        <div class="card-body">
            <table class="table">
                <caption hidden>Metadata</caption>
                <tbody>
                    {%- for field in fields -%}
                        {{ add_field_row(field.name, field.key, (item.get(field.key) or ""), field.editable, api_path, loop.index) }}
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="card">
        <h5 class="card-header">Notes</h5>
        <div class="card-body">
            <table class="table">
                <caption hidden>Notes</caption>
                {{ notes_table_head(item['notes']) }}
                <tbody>
                    {%- for note in item['notes'] -%}
                        {{ notes_table_row(note, "/api/project/" ~ project_id ~ "/object/" ~ object_id ~ "/item/" ~ item.item_id ~ "/notes/" ~ note['note_id']) }}
                    {%- endfor -%}
                    {{ notes_new_button_row(api_path) }}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    {{ super() }}
    {{ note_editor_events("/api/project/" ~ project_id ~ "/object/" ~ object_id ~ "/item/" ~ item.item_id, valid_note_types) }}
{% endblock %}